I found this code browsing github, which I hope to understand much better later.